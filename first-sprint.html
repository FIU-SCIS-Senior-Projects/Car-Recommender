<template name="main">
<img src="http://i.imgur.com/lr0uNjw.jpg" style="width:900px;height:100px;display: block;margin: 0 auto;">	
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
 <body>
 {{#if loggingIn}}
    <!--<p>Loading...</p>-->
  {{else}}
    {{#if currentUser}}     
       <header> {{> dashboard}} </header>      

    <aside>
        {{> yield "aside"}}
    </aside>
    {{else}}
    {{> yield}}<!--tables and forms including the registration and the log in forms-->
    {{/if}}
  {{/if}}

  </body>
	
</template>


<template name="register">
 	<form>
	<div class="col-xs-4">
		<br>
		<legend>Registration</legend>

    <p>{{RegistrationError}}</P>
		<input type="text" name="registerFirstName" placeholder="Enter first name..." class="form-control" pattern="^[a-zA-Z ]+$"  maxlength="20" required>
		<br>
		<input type="text" name="registerLastName" placeholder="Enter last name..." class="form-control" pattern="^[a-zA-Z ]+$"  maxlength="20" required>
		<br>
		<input type="email" name="registerEmail" placeholder="Enter email..." class="form-control" required>
		<br>
		<input type="password" id="registerPassword" name="registerPassword" placeholder="Enter password..." class="form-control" minlength="6" maxlength="30" required>
		<br>
		<input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm password..." onkeyup="checkPass()" class="form-control" minlength="6" maxlength="30" required>
		<script>
		function checkPass() 
		{
			var password = document.getElementById("registerPassword");
			var confirm_password = document.getElementById("confirmPassword");
				function validatePassword()
				{
		  			if(password.value != confirm_password.value) 
					{
						confirm_password.setCustomValidity("Passwords Don't Match");
		  			} 
					else 
					{
						confirm_password.setCustomValidity('');
		  			}
				}
			password.onchange = validatePassword;
			confirm_password.onkeyup = validatePassword;
		}  
		</script>	
		<br>
		<input type="text" name="registerAddress" placeholder="Enter address..." class="form-control" maxlength="300" required>
		<br>
		<input type="text" name="registerState" placeholder="Enter state..." class="form-control" attern="^[a-zA-Z ]+$"  maxlength="20" required>
		<br>
		<input type="text" name="registerZip" placeholder="Enter zip code..." class="form-control" pattern="^[0-9 ]+$" maxlength="35" required>
		<br>
		<input type="tel" name="registerTelephone" placeholder="Enter phone number..." class="form-control" pattern="^[0-9 ]+$" maxlength="35" required>
	    <br>
		<input type="submit" class="btn btn-primary btn-lg active" value="Register" id="registratonsubmit">
    <a href="/" class="btn btn-secondary btn-lg active" role="button">Back</a>        
	</div>
	</form>

</template>

<template name="login">
    <form data-toggle="validator" role="form">
	    <div class="col-xs-4">
		  <br><br><br>
		  <legend>Login</legend>
      <p >{{LogError}}</p>      

          <label class="sr-only" for="form-useremail"> Email </label>	  
          <input type="email" name="loginEmail" placeholder="Email..." class="form-control" id="form-useremail" required>
          <br>
		      <label class="sr-only" for="form-password">Password</label>
          <input type="password" name="loginPassword" placeholder="Password..." class="form-control" id="form-password" required>
		      <br>
          <input type="submit" class="btn btn-primary btn-lg btn-block" value="Login" id="submitlogin"><br>
          <a href="/RecoverPassword">Forgot your password?</a> 
          <br>
		  <a href="/register" >Don't have an account yet? Register for free</a>
		  </div>	
    </form>
</template>

<template name="RecoverPassword">  
  {{#if resetPassword}}
    <form id="set-new-password">
	  <div class="col-xs-4">
	  <br><br><br>	
	  <legend>Reset Password</legend>	  
      <label for="new-password">New Password</label>
      <input type="text" id="new-password" placeholder="Enter new password..." class="form-control">
	  <br>	
      <input type="submit" value="Confirm New Password">
      <p id="form-messages"></p>
	  </div>	  
    </form>
  {{else}}
    <form id="forgot-password">
      <div class="col-xs-4">
	  <br><br><br>	
	  <legend>Recover Password</legend>	  	  
      <input type="text" id="user-email" placeholder="Enter email..." class="form-control">
	  <br>	
      <input type="submit" value="Get Reset Password Instructions">
      <p id="form-messages"></p>
	  </div>	  
    </form>
  {{/if}}
</template>  


<template name="dashboard">
    <div class="container">
         <!-- The justified navigation menu is meant for single line per list item.
           Multiple lines will require custom code not provided by Bootstrap. -->
      <div class="masthead">       
        <nav>
          <ul class="nav nav-tabs nav-justified">
			<li class="{{ activeIfTemplateIs '' }}"><a href="/">Home</a></li>
            <li class="{{ activeIfTemplateIs 'favorites' }}"><a href="/favorites">Favorites</a></li>
            <li class="{{ activeIfTemplateIs 'sell' }}"><a href="/sell">Sell</a></li>            
            <li class="{{ activeIfTemplateIs 'profile' }}"><a href="/profile">Profile</a></li>
            <li class="{{ activeIfTemplateIs 'inventory' }}"><a href="/inventory">Inventory</a></li>
            <li><a href="/" class="logout" id= "logoutmenu">Logout</a></li>
          </ul>
        </nav>
      </div>
    </div>

</template>

<template name="home">
  <br><br><br>  
  <div id="carousel-example-generic" class="carousel slide container" data-ride="carousel">

  <!-- Wrapper for slides -->
  <div class="carousel-inner" role="listbox">
   {{> slidercars2}}
  {{#each cars}}
        {{> slidercars}}         
  {{/each}}
  
  </div>
  <!-- Controls -->
  <a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

</template>

<template name="slidercars">
    <div class="item">
      <img src="{{picture}}" alt="..." class="img-rounded container" id="carpicture" style="width:700px;height:300px;">      
      <div class="carousel-caption" >      
      <p class="">Price:${{price}}</p>
      <button type="button" class="btn btn-success btn-circle btn-lg" id="likebutton" ><i class={{likesign}}></i></button>
      <button type="button" class="btn btn-info btn-circle btn-lg" id="infobutton"><i class="glyphicon glyphicon-info-sign"></i></button>
      <button type="button" class="btn btn-danger btn-circle btn-lg" id="Contactbutton" data-toggle="popover" title="<font color='Black'>seller Contact</font>" data-content="<font color='Black'>{{popoverdata}}</font>" data-html="true"><i class="glyphicon glyphicon-earphone"></i></button>
      {{#if selected}}
      <div name="zeevtable" class="zeevtable" id="zeevtable">
      {{>carinfotable}}
      </div> 
      {{/if}}     
      </div>
    </div>

<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover();   
});
</script> 

</template>

<template name="slidercars2">
    <div class="item active">
      <img src="http://cdn.mysitemyway.com/etc-mysitemyway/icons/legacy-previews/icons/glowing-green-neon-icons-arrows/110949-glowing-green-neon-icon-arrows-arrow1-left-right1.png" alt="..." class="img-rounded container"  style="width:700px;height:300px;">      
      <div class="carousel-caption">              
      <p>Price:</p>
      <button type="button" class="btn btn-success btn-circle btn-lg" id="likebutton"><i class="glyphicon glyphicon-ok"></i></button>
      <button type="button" class="btn btn-info btn-circle btn-lg" id="infobutton" ><i class="glyphicon glyphicon-info-sign"></i></button>
      <button type="button" class="btn btn-danger btn-circle btn-lg" id="Contactbutton" data-toggle="popover" title="<font color='Black'>seller Contact</font>" data-content="<font color='Black'>name: zeev feldbeine <br> Email: zfeld003@fiu.edu <br> Phone: 3059342453 <br>" data-html="true"><i class="glyphicon glyphicon-earphone"></i></button>
      </div>
    </div> 

<script>
$(document).ready(function(){
    $('[data-toggle="popover"]').popover();   
});
</script>
</template>


<template name="carinfotable">
<table class="table table-bordered container" style="color:black; text-align:center; width:70%;">
  <thead>
    <tr class="active">
      <th>properties</th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr class="info">
      <th scope="row">price</th>
      <td>${{price}}</td>
    </tr>
    <tr class="info">
      <th scope="row">make</th>
      <td>{{make}}</td>
    </tr>
    <tr class="info">
      <th scope="row">model</th>
      <td>{{model}}</td>
    </tr>
    <tr class="info">
      <th scope="row">year</th>
      <td>{{year}}</td>
    </tr>
    <tr class="info">
      <th scope="row">type</th>
      <td>{{type}}</td>
    </tr>
    <tr class="info">
      <th scope="row">color</th>
      <td>{{ecolor}}</td>
    </tr>
    <tr class="info">
      <th scope="row">engine</th>
      <td>{{engine}}</td>
    </tr>
    <tr class="info">
      <th scope="row">mileage</th>
      <td>{{mileage}}</td>
    </tr>
  </tbody>
</table>
</template>

<template name="Contacttable">
<table class="table table-bordered container" style="color:black; text-align:center; width:70%;">
  <thead>
    <tr class="active">
      <th>properties</th>
      <th>Contact info</th>
    </tr>
  </thead>
  <tbody>
    <tr class="info">
      <th scope="row">First Name</th>
      <td>{{fname}}</td>
    </tr>
    <tr class="info">
      <th scope="row">Last Name</th>
      <td>{{fname}}</td>
    </tr>
    <tr class="info">
      <th scope="row">Email</th>
      <td>{{email}}</td>
    </tr>
    <tr class="info">
      <th scope="row">phone</th>
      <td>{{phone}}</td>
    </tr>
    <tr class="info">
      <th scope="row">State</th>
      <td>{{state}}</td>
    </tr>
    <tr class="info">
      <th scope="row">Zip Code</th>
      <td>{{zip}}</td>
    </tr>
  </tbody>
</table>
</template>

<template name="favorites">
  <form>
  <div class="col-xs-4 container">
    <br>
    <legend>Your Car favorites</legend>
    {{#each carFavorites}}
      {{#with CarsInfo}}
       <img src="{{picture}}" alt="..." class="img-rounded container" id="favorites" style="width:420px;height:150px;">       
        <div id="FavoritesInformation1">{{>carinfotable}}</div>
        {{#with ContactInfo}}        
        <div id="FavoritesInformation2">{{>Contacttable}}</div>
        {{/with}}
      {{/with}}
      <br>
      <button type="button" id = "favoritesshow" class="btn btn-primary btn-lg btn-block btn-info">Full Info</button>
      <hr>
    {{/each}}
</div>
</form>
</template>

<template name="sell">
  	<form>
	<div class="col-xs-4">
		<br>
		<!--<p color="white">{{currentUser.emails.[0].address}}</p>-->
		<legend>To sell a car, fill the form below:</legend>
		<small>*All fields are required</small><br><br>
		<script>
		var displayImage = function() {
			var carPic = document.getElementById('carPic');
			//carPic.src = URL.createObjectURL(event.target.files[0]);
      carPic.src = event.target.value;
		  };
		</script>
		<input type="text" name="picture" class="form-control" placeholder="image link..."  onchange="displayImage()" required>
    <a href="http://postimage.org/" class="btn btn-primary btn-xs" target="popup" onclick="window.open('http://postimage.org/','name','width=600,height=400')">Get Img Link</a><br>    
		<img src="https://www.volkswagen.co.uk/vw-testdrive/images/cars/summary-angled-transparent/no-selection.png" id="carPic" style="width:200px;height:100px;">
		<br><br>
		
		<select class="form-control" name="year" required>
		  <option value="" disabled selected>Select Year</option>	
		 	{{#each data.year}}  
				<option>{{y}}</option>
			{{/each}}
		</select>
		<br>
		<select class="form-control" name="make" required>
		  <option value="" disabled selected>Select Make</option>	
		 	{{#each data.make}}  
				<option>{{car}}</option>
			{{/each}}
		</select>
		<br>
		<select class="form-control" name="type" required>
		  <option value="" disabled selected>Select Type</option>	
		 	{{#each data.style}}  
				<option>{{s}}</option>
			{{/each}}
		</select>
		<br>
		<input type="text" name="model" class="form-control" placeholder="Enter Model..." maxlength="50" required>
		<br>
		<input type="text" name="mileage" class="form-control" placeholder="Enter Mileage..." pattern="^[0-9 ]+$" maxlength="10" required>
		<br>
		<input type="text" name="cmpg" class="form-control" placeholder="Enter City MPG..." pattern="^[0-9 ]+$" maxlength="10" required>
		<br>
		<input type="text" name="hmpg" class="form-control" placeholder="Enter Highway MPG..." pattern="^[0-9 ]+$" maxlength="10" required>
		<br>
		<select class="form-control" name="engine" required>
		  <option value="" disabled selected>Select Engine</option>	
		 	{{#each data.transmission}}  
				<option>{{t}}</option>
			{{/each}}
		</select>
		<br>
		<select class="form-control" name="cylinder" required>
		  <option value="" disabled selected>Select Cylinder</option>	
		 	{{#each data.cylinder}}  
				<option>{{c}}</option>
			{{/each}}
		</select>
		<br>
		<select class="form-control" name="ecolor" required>
		  <option value="" disabled selected>Select Exterior Color</option>	
		 	{{#each data.ecolor}}  
				<option>{{c}}</option>
			{{/each}}
		</select>
		<br>
		<select class="form-control" name="icolor" required>
		  <option value="" disabled selected>Select Interior Color</option>	
		 	{{#each data.icolor}}  
				<option>{{c}}</option>
			{{/each}}
		</select>
		<br>
		<input type="text" name="price" class="form-control" placeholder="Enter Price in US Dollars (without commas)..." pattern="^[0-9 ]+$" maxlength="10" required>
		<br>
		<input type="submit" class="btn btn-primary btn-lg active" value="Sell this car" id="registratonsubmit">
    <a href="/" class="btn btn-secondary btn-lg active" role="button">Back</a>        
	</div>
	</form> 
</template>

<!-- Displays current user data and cars being sold by said user-->
<template name="profile">
	<form>
		<div class="col-xs-3"><br><br>
			{{#each profile}} 
			<div class="row">
				<div class="panel panel-default panel-transparent">
            		<div class="panel-heading">
						<h3 class="panel-title">{{fname}} {{lname}}</h3>
                    </div>
					<div class="panel-body">
              			<table class="table table-user-information">
								<tbody>
									  <tr>
										<td><p>Email</p></td>
										<td>{{email}}</td>
									  </tr>
									  <tr>
										<td><p>Phone</p></td>
										<td>{{phone}}</td>
									  </tr>
									  <tr>
										<td><p>Address</p></td>
										<td>{{address}}</td>
									  </tr>
									  <tr>	
										<td><p>State</p></td>
										<td>{{state}}</td>
									  </tr>
									  <tr>
										<td><p>Zip Code</p></td>
										<td>{{zip}}</td>
									  </tr>
								  </tbody>
						  </table>
                  	</div>	
				</div>
				<a href="/updateprofile"><input type="submit" class="btn btn-primary btn-lg active" value="Update"></a>&nbsp;&nbsp;&nbsp;&nbsp;
				<a href="/changepassword"><input type="submit" class="btn btn-info btn-lg active" value="Change Password"></a>
			</div>	
			{{/each}}
		</div>
	</form>		
</template>

<template name="updateprofile">
	<form>
		<div class="col-xs-3">
			<h3>Update Your Data</h3>
			{{#each profile}} 
			<small>*No need to fill all fields</small><br>
			<label>First Name</label>
			<input type="text" name="firstName" class="form-control" placeholder={{fname}}>
			<label>Last Name</label>
			<input type="text" name="lastName" class="form-control" placeholder={{lname}}>
			<label>Address</label>
			<input type="text" name="address" class="form-control" placeholder={{address}}>
			<label>State</label>
			<input type="text" name="state" class="form-control" placeholder={{state}}>
			<label>Zipcode</label>
			<input type="text" name="zipcode" class="form-control" placeholder={{zip}}>
			<label>Phone Number</label>
			<input type="text" name="phone" class="form-control" placeholder={{phone}}>
			{{/each}} 
			<br><input type="submit" class="btn btn-primary btn-lg active" value="Update" id="updatesubmit">
			<a href="/profile" class="btn btn-secondary btn-lg active" role="button">Back</a> 
		</div>
	</form>		
</template>
	
<template name="changepassword">
	<form>
		<div class="col-xs-3">
			<h3>Change Your Password</h3>
			<label>Enter Old Password</label>
			<input type="password" class="form-control" name="oldPassword" minlength="6" maxlength="30" required>
			<label>Enter New Password</label>
			<input type="password" class="form-control" id="pswd" name="newPassword" minlength="6" maxlength="30" required>
			<label>Confirm New Password</label>
			<input type="password" class="form-control" id="npswd" name="confirmNewPassword" minlength="6" maxlength="30"  onkeyup="checkPass()" required>
			<script>
			function checkPass() 
			{
				var password = document.getElementById("pswd");
				var confirm_password = document.getElementById("npswd");
					function validatePassword()
					{
						if(password.value != confirm_password.value) 
						{
							confirm_password.setCustomValidity("Passwords Don't Match");
						} 
						else 
						{
							confirm_password.setCustomValidity('');
						}
					}
				password.onchange = validatePassword;
				confirm_password.onkeyup = validatePassword;
			}  
		</script>	
			<br><input type="submit" class="btn btn-info btn-lg active" value="Change Password" id="changepasswordsubmit">
			<a href="/profile" class="btn btn-secondary btn-lg active" role="button">Back</a> 
		</div>
	</form>		
</template>	


<template name="inventory">
	<form>
		<div class="col-xs-3"><br><br>
			{{#each cars}}
				<div class="panel panel-default panel-transparent">
            		<div class="panel-heading">
						<h3 class="panel-title">{{year}} {{make}} {{model}}</h3>
                    </div>
					<div class="panel-body">
              			<table class="table table-user-information">
								<tbody>
									  <tr align="center"><img src={{picture}} style="width:200px;height:120px;"></tr>
									  <tr>
										<td><p>Price</p></td>
										<td>${{price}}</td>
									  </tr>
									  <tr>
										<td><p>Type</p></td>
										<td>{{type}}</td>
									  </tr>
									  <tr>
										<td><p>Mileage</p></td>
										<td>{{mileage}}</td>
									  </tr>
									  <tr>
										<td><p>City MPG</p></td>
										<td>{{cmpg}}</td>
									  </tr>
									  <tr>	
										<td><p>Highway MPG</p></td>
										<td>{{hmpg}}</td>
									  </tr>
									  <tr>
										<td><p>Engine</p></td>
										<td>{{engine}}</td>
									  </tr>
									  <tr>
										<td><p>Cylinder</p></td>
										<td>{{cylinder}}</td>
									  </tr>
									  <tr>
										<td><p>Exterior color</p></td>
										<td>{{ecolor}}</td>
									  </tr>
									  <tr>
										<td><p>Interior color</p></td>
										<td>{{icolor}}</td>
									  </tr>
								</tbody>
						  <a href=/updatecars><input type="submit" class="btn btn-primary btn-lg active" value="Update"></a>
						</table>
                  	</div>	
				</div>	
			<br>
			{{/each}}
		</div>
	</form>		 
</template>


<template name="updatecars">
	<form>
		<div class="col-xs-3">
			<h3>Update Your Inventory</h3>
			<br><input type="submit" class="btn btn-primary btn-lg active" value="Update" id="updatesubmit">
			<a href="/inventory" class="btn btn-secondary btn-lg active" role="button">Back</a> 
		</div>
	</form>		
</template>